---
title: "TUD FOR WEEKDAYS"
author: "Kakau with minor amendments from Ben :-)"
date: 'Last run at: `r Sys.time()`'
output:
  bookdown::html_document2:
    fig_caption: yes
    code_folding: hide
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: TRUE
---

# Weekdays
## Importing Weekdays data
```{r setup}
# packages ----
library(plyr)
library(stringr)
library(tidyverse)
library(tidyr)
library(lubridate)
library(kableExtra)
library(dplyr)
library(scales)
library(ggplot2)

# parameters ----
dPath <- "/Volumes/hum-csafe/Research Projects/FoliakiPhD/tudData/" # edit for your set up
dataF <- path.expand(paste0(dPath, "TUD Weekdays 050520.csv"))
  
```

## Read dataframe


Importing Weekends dataframe

The dataframe is a wide format. I had to clean the data by correcting typo and translating some of the data into english. So the file is not as original as it is when export from qualtrics. 

```{r loadData}

# read in my dataframe
weekdays <- read.csv(dataF, na.strings=c(""), check.names = FALSE, header = TRUE, as.is=TRUE)

head(weekdays)



```

## Create long dataframe
Converting the wide dataframe to long dataframe for easier analysis

Ive noticed that the time is in a character format rather than date. i need to change it to date

> see below

```{r makeLong}

longweekdays <- weekdays %>%
  gather(Time, Activity, 4:51)

head(longweekdays)

```

## Sort by ID
Sorting the TUD dataframe, Firstly, as you can see previously some respondents do not have a secondary activity (i.e NA). Secondly, the data is sorted by time. I think it would be easier to sorted by Household ID. So here i am sorting the data based on ID number

```{r sortByID}
# sorting my dataframe in accending order based on the Household ID
weekdayOrder <- order(longweekdays$`Household ID`)
head(weekdayOrder)

# Applying the sorting order into my "longweekdends" dataframe and call it sortweekends
sortweekdays <- longweekdays[weekdayOrder,]
head(sortweekdays)

names(sortweekdays)
```


## Rearrange by Activity
Here i am seprating the activity columm into a primary activity and a secondary activity

The issue im facing with is the date. It in character and alsoit picked up the current date (2020) rather than the date from the TUD.

> BA: I can't see a date variable. How would R know which date the diary was completed on?

Im trying to sort the date but it comes back N/A

> see below

```{r rearrangeActs}
# Since both the first and second activiies are in one column, i need to separate them into two columns

#call the number of row in my dataframe for the maximum row for my sequence function
nrow(sortweekdays)

#create a new dataframe "newdata" for the primary activity only (all odd rows)
newdata <- sortweekdays[seq(1,8543,2),]
head(newdata)

#create a new datagame "newdata1" for the secondary activity (oall even rows)
newdata1 <- sortweekdays[seq(2,8544,2),]
head(newdata1)

#since i have separated my two acitvities, i need to merge them into one dataframe
newdata$Activity2 <- newdata1$Activity

kableExtra::kable(head(newdata), caption = "Test merged long form data") %>%
  kable_styling()


```

## Fix Time
> BA: fix the time variable so it looks like and acts like HH:MM

```{r fixTime}
#newdata$rawTime <- hms::parse_hm(newdata$Time) # this will only be right for AM
#newdata$AM_PM <- stringr::word(newdata$Time, 2) # get the second word of 'Time' which will be AM or PM

# better solution
# https://stackoverflow.com/questions/7883806/parse-timestamp-with-a-m-p-m
# this will make it today's date and the current time zone by default
newdata$rawTime <- as.POSIXct(newdata$Time, format="%l:%M %p")

# Lesson #1: always enter times as 24 hour clock: HH:MM !!

# Now use that to add 12 hours to rawTime whenit is actually PM
# newdata$fixedTime <- ifelse(newdata$AM_PM =="PM", # if PM
#                             newdata$rawTime + (12 * 60 * 60), #  add 12 hours
#                             newdata$rawTime # otherwise don't
#                             ) 
newdata$fixedHMS <- hms::as_hms(newdata$rawTime) # make sure it is in H:M:S format

t <- table(newdata$Time, newdata$rawTime)
kableExtra::kable(t, caption = "Test time coding") %>%
  kable_styling()
```

## Create dataframe per weekdays

Here i am trying to seprate the data into days so i can analyse the activities.

```{r createWeekdayDataFrames}

#filter newdata dataframe by date using the dplyr

#creating a new dataframe "Monday"
monday <- dplyr::filter(newdata, Day == "Monday")
head(monday)

#creating a new dataframe "Tuesday"
tuesday <- dplyr::filter(newdata, Day == "Tuesday")
head(tuesday)

#creating a new dataframe "Wednesday"
wednesday <- dplyr::filter(newdata, Day == "Wednesday")
head(wednesday)

#creating a new dataframe "Thursday"
thursday <- dplyr::filter(newdata, Day == "Thursday")
head(thursday)

#creating a new dataframe "Friday"
friday <- dplyr::filter(newdata, Day == "Friday")
head(friday)


```


## Frequence (n) and Proportion (%)

So im trying to sort out the coding for Monday so i can copy it for the rest of the weekdays. I've did a frequency and proportion of activities for Monday.

```{r testMonday}


#Monday 

#frequency of Activities
freqA <- table(monday$Activity, exclude=NULL)
freqA
dim(freqA)

#proportion of Activities
propA <- prop.table(freqA)*100
propA <- round(propA, digits=2)
propA

dim(propA)

#creating table with binding
tableMon <- cbind(freqA, propA)
tableMon <- cbind(Gender = rownames(tableMon), tableMon)
rownames(tableMon) <- NULL
tableMon

#rename column names
colnames(tableMon)[colnames(tableMon) == "freqA"] <- "Frequency"
colnames(tableMon)[colnames(tableMon) == "propA"] <- "Proportion (%)"
tableMon

#using kable extra to create better table format
tableMonday <- kable(tableMon)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableMonday


#Tueday

#frequency of Activities
freqTue <- table(tuesday$Activity, exclude=NULL)
freqTue
dim(freqTue)

#proportion of Activities
propTue <- prop.table(freqTue)*100
propTue <- round(propTue, digits=2)
propTue

dim(propTue)

#creating table with binding
tableTue <- cbind(freqTue, propTue)
tableTue <- cbind(Gender = rownames(tableTue), tableTue)
rownames(tableTue) <- NULL
tableTue

#rename column names
colnames(tableTue)[colnames(tableTue) == "freqTue"] <- "Frequency"
colnames(tableTue)[colnames(tableTue) == "propTue"] <- "Proportion (%)"
tableTue

#using kable extra to create better table format
tableTuesday <- kable(tableTue)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableTuesday

#Wednesday
#frequency of Activities
freqWed <- table(wednesday$Activity, exclude=NULL)
freqWed
dim(freqWed)

#proportion of Activities
propWed <- prop.table(freqWed)*100
propWed <- round(propWed, digits=2)
propWed

dim(propWed)

#creating table with binding
tableWed <- cbind(freqWed, propWed)
tableWed <- cbind(Gender = rownames(tableWed), tableWed)
rownames(tableWed) <- NULL
tableWed

#rename column names
colnames(tableWed)[colnames(tableWed) == "freqWed"] <- "Frequency"
colnames(tableWed)[colnames(tableWed) == "propWed"] <- "Proportion (%)"
tableWed

#using kable extra to create better table format
tableWednesday <- kable(tableWed)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableWednesday

#Thursday
#frequency of Activities
freqThu <- table(thursday$Activity, exclude=NULL)
freqThu
dim(freqThu)

#proportion of Activities
propThu <- prop.table(freqThu)*100
propThu <- round(propThu, digits=2)
propThu

dim(propThu)

#creating table with binding
tableThu <- cbind(freqThu, propThu)
tableThu <- cbind(Gender = rownames(tableThu), tableThu)
rownames(tableThu) <- NULL
tableThu

#rename column names
colnames(tableThu)[colnames(tableThu) == "freqThu"] <- "Frequency"
colnames(tableThu)[colnames(tableThu) == "propThu"] <- "Proportion (%)"
tableThu

#using kable extra to create better table format
tableThursday <- kable(tableThu)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableThursday

#Friday
#frequency of Activities
freqFri <- table(friday$Activity, exclude=NULL)
freqFri
dim(freqFri)

#proportion of Activities
propFri <- prop.table(freqFri)*100
propFri <- round(propFri, digits=2)
propFri

dim(propFri)

#creating table with binding
tableFri <- cbind(freqFri, propFri)
tableFri <- cbind(Gender = rownames(tableFri), tableFri)
rownames(tableFri) <- NULL
tableFri

#rename column names
colnames(tableFri)[colnames(tableFri) == "freqFri"] <- "Frequency"
colnames(tableFri)[colnames(tableFri) == "propFri"] <- "Proportion (%)"
tableFri

#using kable extra to create better table format
tableFriday <- kable(tableFri)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableFriday

#weekdays
#frequency of Activities
freqwkd <- table(newdata$Activity, exclude=NULL)
freqwkd
dim(freqwkd)

#proportion of Activities
propwkd <- prop.table(freqwkd)*100
propwkd <- round(propwkd, digits=2)
propwkd

dim(propwkd)

#creating table with binding
tablewkd <- cbind(freqwkd, propwkd)
tablewkd <- cbind(Gender = rownames(tablewkd), tablewkd)
rownames(tablewkd) <- NULL
tablewkd

#rename column names
colnames(tablewkd)[colnames(tablewkd) == "freqwkd"] <- "Frequency"
colnames(tablewkd)[colnames(tableTue) == "propwkd"] <- "Proportion (%)"
tablewkd

#using kable extra to create better table format
tableWeekdays <- kable(tablewkd)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableWeekdays
```



## Weekdays group by acitivities
Im trying to see the count for all the activities in the TUD

```{r mondayGroupActs}
#Monday
groupbymonAct <- monday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbymonAct

#Tuesday
groupbytueAct <- tuesday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbytueAct

#Wednesday
groupbywedAct <- wednesday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbywedAct

#Thursday
groupbythuAct <- thursday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbythuAct

#Friday
groupbyfriAct <- friday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbyfriAct

#Weekdays
groupbyWkdAct <- newdata %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbyWkdAct
```

Im am trying to remove sleeping, rest, going to work from the data so that i can only focus on the rest of the acitivities.

The issue i am facing as the time is not sorted in accending order. Can you help with the coding

> yep - see what I did :-)


```{r mondayFilter}
tableAll <- monday %>%
  #select(Time, Activity) %>% 
  select(fixedHMS, Activity) %>% # use the new time variable
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  #group_by(Time) %>% 
  group_by(fixedHMS) %>% 
  tally

kableExtra::kable(tableAll, caption = "Monday test (no sleep/rest/work)") %>%
  kable_styling()

# plot
ggplot2::ggplot(tableAll, aes(x = fixedHMS, y = n)) +
  geom_col()
```

## Cooking related activity

Here im am trying to look at anything related to preparing and eating a meal. 

```{r mondayCook}
# creating dataframe for all cooking
#Monday
tableCooking <- monday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCooking

MonCook <- ggplot(tableCooking, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Monday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

MonCook

#Tuesday

tableCookingTue <- tuesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingTue

TueCook <- ggplot(tableCookingTue, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Tuesday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

TueCook

#Wednesday

tableCookingWed <- wednesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingWed

WedCook <- ggplot(tableCookingWed, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Wednesday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WedCook

#Thursday

tableCookingThu <- thursday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingThu

ThuCook <- ggplot(tableCookingThu, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Thursday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

ThuCook

#Friday


tableCookingFri <- friday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingFri

FriCook <- ggplot(tableCookingFri, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Friday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

FriCook

#Weekdays

tableCookingWkd <- newdata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingWkd

WkdCook <- ggplot(tableCookingWkd, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Weekdays Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WkdCook

```


## Tidy up related activities

similar to the above but for tidy up/cleaning up
```{r mondayTidyUp}
# creating dataframe for all cleaning up

#Monday
mondayTidyup <- monday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
mondayTidyup

MondayTidy <- ggplot(mondayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Monday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

MondayTidy

#Tuesday
tuesdayTidyup <- tuesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tuesdayTidyup

TuesdayTidy <- ggplot(tuesdayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Tuesday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

TuesdayTidy

#Wednesday
wednesdayTidyup <- wednesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
wednesdayTidyup

WednesdayTidy <- ggplot(wednesdayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Wednesday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WednesdayTidy

#Thursday
thursdayTidyup <- thursday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
thursdayTidyup

ThursdayTidy <- ggplot(thursdayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Thursday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

ThursdayTidy

#Friday
fridayTidyup <- friday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
fridayTidyup

FridayTidy <- ggplot(fridayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Friday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

FridayTidy

#Weekdays
weekdaysTidyup <- newdata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekdaysTidyup

WeekdaysTidy <- ggplot(weekdaysTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Weekdays Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekdaysTidy

```


## Leisure related acitivities

  similar to the above but for leisure
```{r momdayLeisure}
# creating dataframe for all leisure

#Monday
mondayleisure <- monday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
mondayleisure

Mondayleisure <- ggplot(mondayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Monday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Mondayleisure

#Tuesday
tuesdayleisure <- tuesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tuesdayleisure

Tuesdayleisure <- ggplot(tuesdayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Tuesday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Tuesdayleisure

#Wednesday
wednesdayleisure <- wednesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
wednesdayleisure

Wednesdayleisure <- ggplot(wednesdayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Wednesday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Wednesdayleisure

#Thursday
thursdayleisure <- thursday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
thursdayleisure

Thursdayleisure <- ggplot(thursdayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Thursday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Thursdayleisure

#Friday
fridayleisure <- friday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
fridayleisure

Fridayleisure <- ggplot(fridayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Friday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Fridayleisure

#Weekdays
weekdaysleisure <- newdata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekdaysleisure

Weekdayleisure <- ggplot(weekdaysleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Weekdays Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Weekdayleisure
```

## Away from home
similar to the above but for away from home
```{r mondayAway}
# creating dataframe for Away from Home

#Monday
mondayAway <- monday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
mondayAway

MondayAwayHome <- ggplot(mondayAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Monday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

MondayAwayHome

#Tuesday
tuesdayAway <- tuesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tuesdayAway

TuesdayAwayHome <- ggplot(tuesdayAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Tuesday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

TuesdayAwayHome

#Wednesday
wednesdayAway <- wednesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
wednesdayAway

WednesdayAwayHome <- ggplot(wednesdayAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Wednesday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WednesdayAwayHome

#Thursday
thursdayAway <- thursday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
thursdayAway

ThursdayAwayHome <- ggplot(thursdayAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Monday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

ThursdayAwayHome

#Friday
fridayAway <- friday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
fridayAway

FridayAwayHome <- ggplot(fridayAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Friday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

FridayAwayHome

#Weekday
weekdayAway <- newdata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekdayAway

WeekdaysAwayHome <- ggplot(weekdayAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Weekdays Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekdaysAwayHome
```

## Travelling
similar to the above but for transportation

> BA: table breaks for some reason?

```{r mondayTransport}
# creating dataframe for transportation

# Monday
mondayTransport <- monday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
mondayTransport

#ploting Bar graph

MondayTransport <- ggplot(mondayTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Monday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

MondayTransport

# Tuesday
tuesdayTransport <- tuesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tuesdayTransport

#ploting Bar graph

TuesdayTransport <- ggplot(tuesdayTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Tuesday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

TuesdayTransport

# Wednesday
wednesdayTransport <- wednesday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
wednesdayTransport

#ploting Bar graph

WednesdayTransport <- ggplot(wednesdayTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Wednesday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WednesdayTransport

# Thursday
thursdayTransport <- thursday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
thursdayTransport

#ploting Bar graph

ThursdayTransport <- ggplot(thursdayTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Thursday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

ThursdayTransport

# Friday
fridayTransport <- friday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
fridayTransport

#ploting Bar graph

FridayTransport <- ggplot(fridayTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Friday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

FridayTransport

# Weekday
weekdayTransport <- newdata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekdayTransport

#ploting Bar graph

WeekdaysTransport <- ggplot(weekdayTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Weekdays Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekdaysTransport

```

## Plotting acitivities for each weekdays

I wanted to put all the graphs in one page

```{r gridTheGraphs}
#graphs in one page

library(grid)
library(gridExtra)
library(gridBase)


```

> BA: I would do this a different way by re-coding and putting all the plots in one plot:

```{r onePlot}
# I would use data.table for this, not because it is the best way but because I know how to use it!
library(data.table)
mondayDT <- data.table::as.data.table(monday)
mondayDT[, ba_act := ifelse(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack"), 
                            "Cooking", # <- new code
                            NA)
         ]

mondayDT[, ba_act := ifelse(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals"),
                            "Tidy up", 
                            ba_act)
         ]

mondayDT[, ba_act := ifelse(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)"), 
                            "Leisure", 
                            ba_act)
         ]

mondayDT[, ba_act := ifelse(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"), 
                            "Away", 
                            ba_act)
         ]

mondayDT[, ba_act := ifelse(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)"), 
                            "Transport", 
                            ba_act)
         ]

t <- table(mondayDT$Activity, mondayDT$ba_act, useNA = "always")

kableExtra::kable(t, caption = "Test activity coding") %>%
  kable_styling()

# make a summary table for the plot
plotDT <- mondayDT[!is.na(ba_act), # excludes all NAs - see table to check coding 
                   .(count = .N), keyby = .(fixedHMS, ba_act)]

ggplot2::ggplot(plotDT, aes(x = fixedHMS, y = count, fill = ba_act)) +
  geom_col() +
  scale_fill_discrete(name="Activity (filtered)")
```

## All weekdays plotted using facets/plot

Figure \@ref(fig:allWeekdays) shows counts for all days. We can see a few days are unknown. Also we have higher counts on Mondays.

```{r allWeekdays, fig.cap="All days"}
# use the all days table and the same coding method but across all days

allDaysDT <- data.table::as.data.table(newdata)

allDaysDT[, dayF := factor(Day,
                        levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday") # sets the order for the plot
                        )
       ]

allDaysDT[, ba_act := ifelse(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack"), 
                            "Cooking", # <- new code
                            NA)
         ]

allDaysDT[, ba_act := ifelse(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals"),
                            "Tidy up", 
                            ba_act)
         ]

allDaysDT[, ba_act := ifelse(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)"), 
                            "Leisure", 
                            ba_act)
         ]

allDaysDT[, ba_act := ifelse(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"), 
                            "Away", 
                            ba_act)
         ]

allDaysDT[, ba_act := ifelse(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)"), 
                            "Transport", 
                            ba_act)
         ]

# t <- table(allDaysDT$Activity, allDaysDT$ba_act, useNA = "always")
# 
# kableExtra::kable(t, caption = "Test activity coding (all days)") %>%
#   kable_styling()

# make a summary table for the plot
plotDT <- allDaysDT[!is.na(ba_act), # excludes all NAs - see table to check coding 
                   .(count = .N), 
                   keyby = .(fixedHMS, ba_act, dayF)] # use new day factor



ggplot2::ggplot(plotDT, aes(x = fixedHMS, y = count, fill = ba_act)) +
  geom_col() +
  facet_grid(dayF ~ .) +
  scale_fill_discrete(name="Activity (filtered)")

t <- with(allDaysDT[!is.na(ba_act)], # select the ones we re-coded only
          table(ba_act, dayF))

kableExtra::kable(t, caption = "Number of recorded coded acts by day (non recoded actas e.g. sleeping ignored)") %>%
  kable_styling()

t <- allDaysDT[, .(nRespondents = uniqueN(`Household ID`)), keyby = .(dayF)]

kableExtra::kable(t, caption = "Number of unique respondents by day (all acts)") %>%
  kable_styling()
```

## Number of villages

There are a lot of Mondays in this data...

How many are there per village?

```{r villageDays}

dt <- allDaysDT[, .(n = uniqueN(`Household ID`)), 
                   keyby = .(Village)]



kableExtra::kable(dt, caption = "Number of respondents by village")
```


Ben, so far with the graphs not convinced its good enough, how can i use "proportion" instead of "count" in the Y axis? Given the uneven distribution of respondents per day



# Conclusions


# Weekend Data
## Importing weekend data

```{r setup}

# parameters ----
gPath <- "/Volumes/hum-csafe/Research Projects/FoliakiPhD/tudData/" # edit for your set up
datag <- path.expand(paste0(gPath, "TUD Weekend 050520.csv"))
  
```

## Dataframe

```{r loadData}

# read in my dataframe
weekend <- read.csv(datag, na.strings=c(""), check.names = FALSE, header = TRUE, as.is=TRUE)

head(weekend)


```

## Create long dataframe
```{r makeLong}

longweekend <- weekend %>%
  gather(Time, Activity, 4:51)

head(longweekend)

```

## Sort by ID
```{r sortByID}
# sorting my dataframe in accending order based on the Household ID
weekendOrder <- order(longweekend$`Household ID`)
head(weekendOrder)

# Applying the sorting order into my "longweekends" dataframe and call it sortweekends
sortweekend <- longweekend[weekendOrder,]
head(sortweekend)

names(sortweekend)
```

## Rearrange Activity
```{r rearrangeActs}
# Since both the first and second activiies are in one column, i need to separate them into two columns

#call the number of row in my dataframe for the maximum row for my sequence function
nrow(sortweekend)

#create a new dataframe "newdata" for the primary activity only (all odd rows)
weekenddata <- sortweekend[seq(1,8543,2),]
head(weekenddata)

#create a new datagame "newdata1" for the secondary activity (oall even rows)
weekenddata1 <- sortweekend[seq(2,8544,2),]
head(weekenddata1)

#since i have separated my two acitvities, i need to merge them into one dataframe
weekenddata$Activity2 <- weekenddata1$Activity

kableExtra::kable(head(weekenddata), caption = "Test merged long form data") %>%
  kable_styling()


```

## Fix Time
```{r fixTime}

weekenddata$rawTime <- as.POSIXct(weekenddata$Time, format="%l:%M %p")

weekenddata$fixedHMS <- hms::as_hms(weekenddata$rawTime) # make sure it is in H:M:S format

weekendt <- table(weekenddata$Time, weekenddata$rawTime)
kableExtra::kable(weekendt, caption = "Test time coding") %>%
  kable_styling()
```

## Create dataframe per weekendays
```{r createWeekendDataFrames}

#filter weekend dataframe by date using the dplyr

#creating a new dataframe "Saturday"
saturday <- dplyr::filter(weekenddata, Day == "Saturday")
head(saturday)

#creating a new dataframe "Sunday"
sunday <- dplyr::filter(weekenddata, Day == "Sunday")
head(sunday)


```


## Frequency (n) and Proportion (%)
```{r testWeekendFrequencyProportion}

#Saturday 

#frequency of Activities
freqSat <- table(saturday$Activity, exclude=NULL)
freqSat
dim(freqSat)

#proportion of Activities
propSat <- prop.table(freqSat)*100
propSat <- round(propSat, digits=2)
propSat

dim(propSat)

#creating table with binding
tableSat <- cbind(freqSat, propSat)
tableSat <- cbind(Gender = rownames(tableSat), tableSat)
rownames(tableSat) <- NULL
tableSat

#rename column names
colnames(tableSat)[colnames(tableSat) == "freqSat"] <- "Frequency"
colnames(tableSat)[colnames(tableSat) == "propSat"] <- "Proportion (%)"
tableSat

#using kable extra to create better table format
tableSaturday <- kable(tableSat)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableSaturday

#Sunday

#frequency of Activities
freqSun <- table(sunday$Activity, exclude=NULL)
freqSun
dim(freqSun)

#proportion of Activities
propSun <- prop.table(freqSun)*100
propSun <- round(propSun, digits=2)
propSun

dim(propSun)

#creating table with binding
tableSun <- cbind(freqSun, propSun)
tableSun <- cbind(Gender = rownames(tableSun), tableSun)
rownames(tableSun) <- NULL
tableSun

#rename column names
colnames(tableSun)[colnames(tableSun) == "freqSun"] <- "Frequency"
colnames(tableSun)[colnames(tableSun) == "propSun"] <- "Proportion (%)"
tableSun

#using kable extra to create better table format
tableSunday <- kable(tableSun)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableSunday

#Weekend

#frequency of Activities
freqWeekend <- table(weekenddata$Activity, exclude=NULL)
freqWeekend
dim(freqWeekend)

#proportion of Activities
propWeekend <- prop.table(freqWeekend)*100
propWeekend <- round(propWeekend, digits=2)
propWeekend

dim(propWeekend)

#creating table with binding
tableWeekend <- cbind(freqWeekend, propWeekend)
tableWeekend <- cbind(Gender = rownames(tableWeekend), tableWeekend)
rownames(tableWeekend) <- NULL
tableWeekend

#rename column names
colnames(tableWeekend)[colnames(tableWeekend) == "freqWeekend"] <- "Frequency"
colnames(tableWeekend)[colnames(tableWeekend) == "propWeekend"] <- "Proportion (%)"
tableWeekend

#using kable extra to create better table format
tableWeekend <- kable(tableWeekend)%>%
  kable_styling(bootstrap_options = "striped", full_width = F)

tableWeekend


```


## Weekend days by Activity
```{r weekendGroupActs}
#Saturday
groupbysatAct <- saturday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbysatAct

#Sunday
groupbysunAct <- sunday %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbysunAct

#weekend
groupbyweekendAct <- weekenddata %>%
  dplyr::group_by(Activity) %>%
  dplyr::summarize(count = n())
groupbyweekendAct

```


## Activity trend (exclude sleeping)
```{r WeekendNoSleepFilter}

#Satruday
tableSatnosleep <- saturday %>%
  #select(Time, Activity) %>% 
  select(fixedHMS, Activity) %>% # use the new time variable
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  #group_by(Time) %>% 
  group_by(fixedHMS) %>% 
  tally

kableExtra::kable(tableSatnosleep, caption = "Saturday test (no sleep/rest/work)") %>%
  kable_styling()

# plot
ggplot2::ggplot(tableSatnosleep, aes(x = fixedHMS, y = n)) +
  geom_col()

#Sunday
tableSunnosleep <- sunday %>%
  #select(Time, Activity) %>% 
  select(fixedHMS, Activity) %>% # use the new time variable
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  #group_by(Time) %>% 
  group_by(fixedHMS) %>% 
  tally

kableExtra::kable(tableSunnosleep, caption = "Sunday test (no sleep/rest/work)") %>%
  kable_styling()

# plot
ggplot2::ggplot(tableSunnosleep, aes(x = fixedHMS, y = n)) +
  geom_col()

#Weekdays
tableWkendnosleep <- weekenddata %>%
  #select(Time, Activity) %>% 
  select(fixedHMS, Activity) %>% # use the new time variable
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  #group_by(Time) %>% 
  group_by(fixedHMS) %>% 
  tally

kableExtra::kable(tableWkendnosleep, caption = "Weekend test (no sleep/rest/work)") %>%
  kable_styling()

# plot
ggplot2::ggplot(tableWkendnosleep, aes(x = fixedHMS, y = n)) +
  geom_col()

```

## Cooking related acitivity
```{r WeekendCook}
# creating dataframe for all cooking
#Saturday
tableCookingSat <- saturday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack",
                         "Baking")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingSat

SatCook <- ggplot(tableCookingSat, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Saturday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SatCook

#Sunday
tableCookingSun <- sunday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack",
                         "Baking")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingSun

SunCook <- ggplot(tableCookingSun, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Sunday Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SunCook

#Weekend
tableCookingWeekend <- weekenddata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner", 
                         "Light meal/snack",
                         "Baking")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
tableCookingWeekend

WeekendCook <- ggplot(tableCookingWeekend, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="blue", fill="blue") +
  ggtitle("Weekend Cooking") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekendCook
```

## Tidy up related activity
```{r WeekendTidyUp}
# creating dataframe for all cleaning up

#Saturday
saturdayTidyup <- saturday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
saturdayTidyup

SaturdayTidy <- ggplot(saturdayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Saturday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SaturdayTidy


#Sunday
sundayTidyup <- sunday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
sundayTidyup

SundayTidy <- ggplot(sundayTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Sunday Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SundayTidy

#Weekend
weekendTidyup <- weekenddata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekendTidyup

WeekendTidy <- ggplot(weekendTidyup, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="red", fill="red") +
  ggtitle("Weekend Tidy up") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekendTidy

```


## Leisure related activity
```{r weekendLeisure}
# creating dataframe for all leisure

#Saturday
saturdayleisure <- saturday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
saturdayleisure

Saturdayleisure <- ggplot(saturdayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Saturday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Saturdayleisure

#Sunday
sundayleisure <- sunday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
sundayleisure

Sundayleisure <- ggplot(sundayleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Sunday Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Sundayleisure

#Weekend
weekendleisure <- weekenddata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekendleisure

Weekendleisure <- ggplot(weekendleisure, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="violet", fill="violet") +
  ggtitle("Weekend Leisure") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

Weekendleisure

```


## Away from home 
```{r weekendAway}
# creating dataframe for Away from Home

#Saturday
satAway <- saturday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
satAway

SaturdayAwayHome <- ggplot(satAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Saturday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SaturdayAwayHome

#Sunday
sunAway <- sunday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
sunAway

SundayAwayHome <- ggplot(sunAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Sunday Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SundayAwayHome

#Weekday
weekendAway <- weekenddata%>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>% 
  filter(Activity != "Rest") %>% 
  filter(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"))%>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekendAway

WeekendAwayHome <- ggplot(weekendAway, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="orange", fill="orange") +
  ggtitle("Weekend Away From Home") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekendAwayHome

```

## Travelling
```{r WeekendTransport}
# creating dataframe for transportation

# Saturday
satTransport <- saturday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
satTransport

#ploting Bar graph

SaturdayTransport <- ggplot(satTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Saturday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SaturdayTransport

# Sunday
sunTransport <- sunday %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
sunTransport

#ploting Bar graph

SundayTransport <- ggplot(sunTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Sunday Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

SundayTransport

# Weekend
weekendTransport <- weekenddata %>%
  select(fixedHMS, Activity) %>% 
  filter(Activity != "Sleeping") %>%
  filter(Activity != "Rest") %>%
  filter(Activity != "Work") %>%
  filter(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)")) %>% 
  group_by(fixedHMS) %>% 
  tally
  
  
weekendTransport

#ploting Bar graph

WeekendTravelling <- ggplot(weekendTransport, aes(x = fixedHMS, y = n)) + geom_bar(stat = "identity", position = "stack", color="purple", fill="purple") +
  ggtitle("Weekend Travelling") +
  xlab("Time ") +
  ylab("n") + theme(plot.title = element_text(color="Black", size=11, face="bold.italic", hjust=0.5,lineheight=0.8),
        axis.title.x = element_text(color="black", size=10, face="bold"),
        axis.title.y = element_text(color="black", size=10, face="bold"),
        panel.background=element_rect(fill = "white"),
        panel.grid.minor = element_blank(),
        panel.grid.major = element_blank(), 
        axis.line = element_line(colour = "black", size = 1) + 
        scale_x_date(labels = date_format("%I:%M %p"))
)

WeekendTravelling
```


## Plotting Activity by weekend day
```{r onePlot}
# I would use data.table for this, not because it is the best way but because I know how to use it!

#Saturday 

library(data.table)
saturdayDT <- data.table::as.data.table(saturday)
saturdayDT[, ba_act := ifelse(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner",
                         "baking",
                         "Light meal/snack"), 
                            "Cooking",# <- new code
                           NA)
         ]

saturdayDT[, ba_act := ifelse(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals"),
                            "Tidy up", 
                            ba_act)
         ]

saturdayDT[, ba_act := ifelse(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)"), 
                            "Leisure", 
                            ba_act)
         ]

saturdayDT[, ba_act := ifelse(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"), 
                            "Away", 
                            ba_act)
         ]

saturdayDT[, ba_act := ifelse(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)"), 
                            "Transport", 
                            ba_act)
         ]

satoneplot <- table(saturdayDT$Activity, saturdayDT$ba_act, useNA = "always")

kableExtra::kable(satoneplot, caption = "Saturday activity coding") %>%
  kable_styling()

# make a summary table for the plot
plotsatDT <- saturdayDT[!is.na(ba_act), # excludes all NAs - see table to check coding 
                   .(count = .N), keyby = .(fixedHMS, ba_act)]

ggplot2::ggplot(plotsatDT, aes(x = fixedHMS, y = count, fill = ba_act)) +
  geom_col() +
  scale_fill_discrete(name="Activity (filtered)")

#Sunday 

sundayDT <- data.table::as.data.table(sunday)
sundayDT[, ba_act := ifelse(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner",
                         "baking",
                         "Light meal/snack"), 
                            "Cooking",# <- new code
                           NA)
         ]

sundayDT[, ba_act := ifelse(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals"),
                            "Tidy up", 
                            ba_act)
         ]

sundayDT[, ba_act := ifelse(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)"), 
                            "Leisure", 
                            ba_act)
         ]

sundayDT[, ba_act := ifelse(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"), 
                            "Away", 
                            ba_act)
         ]

sundayDT[, ba_act := ifelse(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)"), 
                            "Transport", 
                            ba_act)
         ]

sunoneplot <- table(sundayDT$Activity, sundayDT$ba_act, useNA = "always")

kableExtra::kable(sunoneplot, caption = "Sunday Test activity coding") %>%
  kable_styling()

# make a summary table for the plot
plotsunDT <- sundayDT[!is.na(ba_act), # excludes all NAs - see table to check coding 
                   .(count = .N), keyby = .(fixedHMS, ba_act)]

ggplot2::ggplot(plotsunDT, aes(x = fixedHMS, y = count, fill = ba_act)) +
  geom_col() +
  scale_fill_discrete(name="Activity (filtered)")

#Weekend 

weekendDT <- data.table::as.data.table(weekenddata)
weekendDT[, ba_act := ifelse(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner",
                         "baking",
                         "Light meal/snack"), 
                            "Cooking",# <- new code
                           NA)
         ]

weekendDT[, ba_act := ifelse(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals"),
                            "Tidy up", 
                            ba_act)
         ]

weekendDT[, ba_act := ifelse(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)"), 
                            "Leisure", 
                            ba_act)
         ]

weekendDT[, ba_act := ifelse(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"), 
                            "Away", 
                            ba_act)
         ]

weekendDT[, ba_act := ifelse(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)"), 
                            "Transport", 
                            ba_act)
         ]

weekendoneplot <- table(weekendDT$Activity, weekendDT$ba_act, useNA = "always")

kableExtra::kable(weekendoneplot, caption = "Weekd activity coding") %>%
  kable_styling()

# make a summary table for the plot
plotsweekendDT <- weekendDT[!is.na(ba_act), # excludes all NAs - see table to check coding 
                   .(count = .N), keyby = .(fixedHMS, ba_act)]

ggplot2::ggplot(plotsweekendDT, aes(x = fixedHMS, y = count, fill = ba_act)) +
  geom_col() +
  scale_fill_discrete(name="Activity (filtered)")

```


## Plotting all graphs in one Plot
```{r allWeekends, fig.cap="All days"}
# use the all days table and the same coding method but across all days

allweekenddaysDT <- data.table::as.data.table(weekenddata)

allweekenddaysDT[, dayF := factor(Day,
                        levels = c("Saturday", "Sunday") # sets the order for the plot
                        )
       ]

allweekenddaysDT[, ba_act := ifelse(Activity %in% c("Cooking", 
                         "Cooking (business)", 
                         "Cooking (baby)",
                         "Cooking (lunch)", 
                         "Food prep (business)", 
                         "Lunch", 
                         "Breakfast", 
                         "Dinner",
                         "Baking",
                         "Light meal/snack"), 
                            "Cooking", # <- new code
                            NA)
         ]

allweekenddaysDT[, ba_act := ifelse(Activity %in% c("Tidy up", 
                         "Laundry", 
                         "Showering", 
                         "Showering (kids)", 
                         "Gardening", 
                         "Getting dressed", 
                         "Getting dressed (kids)",
                         "Prepare kids bag for school",
                         "Turning off applicances/Lights", 
                         "Turning on appliances/lights", 
                         "Ironing", 
                         "Feeding animals"),
                            "Tidy up", 
                            ba_act)
         ]

allweekenddaysDT[, ba_act := ifelse(Activity %in% c("Babysitting", 
                         "Charging mobile devices", 
                         "Family devotion",
                         "Exercise (Jog, walk)",
                         "Family time (chatting, games etc)",
                         "Homework (kids)",
                         "Kids bedtime",
                         "Listen to music/radio",
                         "Mobile devices (movies)",
                         "Mobile devices (games)",
                         "Mobile devices (work)",
                         "Mobile devices (browsing, social media)",
                         "Scripture study",
                         "Studying", 
                         "Reading",
                         "Watching movies (TV)"), 
                            "Leisure", 
                            ba_act)
         ]

allweekenddaysDT[, ba_act := ifelse(Activity %in% c("Farm", 
                         "Relatives", 
                         "Work", 
                         "Kava", 
                         "Church", 
                         "Church (social activities)", 
                         "Church (choir practice)", 
                         "Exercise (Jog, walk)", 
                         "Gym",
                         "Sports",
                         "School", 
                         "Going out"), 
                            "Away", 
                            ba_act)
         ]

allweekenddaysDT[, ba_act := ifelse(Activity %in% c("Driving (church)", 
                         "Driving (drop kids)", 
                         "Driving (drop relatives)",
                         "Driving (farm)", 
                         "Driving (free time)", 
                         "Driving (gym)", 
                         "Driving (home)", 
                         "Driving (Kava)", 
                         "Driving (order delivery)", 
                         "Driving (pick up kids)", 
                         "Driving (visiting relatives)", 
                         "Driving (work)", 
                         "Public transport (home)", 
                         "Public transport (work)", 
                         "Public transport (school)", 
                         "Walking (home)",  
                         "Walking (work)", 
                         "Walking (Kava)"), 
                            "Transport", 
                            ba_act)
         ]

# t <- table(allDaysDT$Activity, allDaysDT$ba_act, useNA = "always")
# 
# kableExtra::kable(t, caption = "Test activity coding (all days)") %>%
#   kable_styling()

# make a summary table for the plot
plotweekendtDT <- allweekenddaysDT[!is.na(ba_act), # excludes all NAs - see table to check coding 
                   .(count = .N), 
                   keyby = .(fixedHMS, ba_act, dayF)] # use new day factor



ggplot2::ggplot(plotweekendtDT, aes(x = fixedHMS, y = count, fill = ba_act)) +
  geom_col() +
  facet_grid(dayF ~ .) +
  scale_fill_discrete(name="Activity (filtered)")

weekendt <- with(allweekenddaysDT[!is.na(ba_act)], # select the ones we re-coded only
          table(ba_act, dayF))

kableExtra::kable(weekendt, caption = "Number of recorded coded acts by day (non recoded actas e.g. sleeping ignored)") %>%
  kable_styling()

weekendt <- allweekenddaysDT[, .(nRespondents = uniqueN(`Household ID`)), keyby = .(dayF)]

kableExtra::kable(weekendt, caption = "Number of unique respondents by day (all acts)") %>%
  kable_styling()
```

# Socio-demographic

## Importing SD data

```{r setup}

# parameters ----
sdPath <- "/Volumes/hum-csafe/Research Projects/FoliakiPhD/tudData/" # edit for your set up
datasd <- path.expand(paste0(sdPath, "Social demographics 050520.csv"))
  
```

## Dataframe

```{r loadData}

# read in my dataframe
socialdemo <- read.csv(datasd, na.strings=c(""), check.names = FALSE, header = TRUE, as.is=TRUE)

head(socialdemo)


```

## Gender
what is the distribution of gender in my data?
```{r frequency}

groupbygen <- socialdemo %>%
  dplyr::group_by(Gender) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)
groupbygen

# plot
ggplot2::ggplot(groupbygen, aes(x = Gender, y = freq)) +
  geom_col() 

````


## Age
what is the age distribution?
```{r frequency}

groupbyage <- socialdemo %>%
  dplyr::group_by(Age) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)
groupbyage

# plot
ggplot2::ggplot(groupbyage, aes(x = Age, y = freq)) +
  geom_col() 

````

## Education
What is the education distribution?

```{r frequency}

groupbyedu <- socialdemo %>%
  dplyr::group_by(Education) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)
groupbyedu

# plot
ggplot2::ggplot(groupbyedu, aes(x = Education, y = freq)) +
  geom_col() 
````

## Religion
What is the education distribution?

```{r frequency}

groupbyrel <- socialdemo %>%
  dplyr::group_by(Religion) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)
groupbyrel

# plot
ggplot2::ggplot(groupbyrel, aes(x = Religion, y = freq)) +
  geom_col() 

````


## Martial Status
What is the martial status distribution?

```{r frequency}

groupbymar <- socialdemo %>%
  dplyr::group_by(Martial_Status) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)

groupbymar

# plot
ggplot2::ggplot(groupbymar, aes(x = Martial_Status, y = freq)) +
  geom_col() 
````


## Employment
What is the Employment distribution?

```{r frequency}

groupbyjob <- socialdemo %>%
  dplyr::group_by(Employment_Classification) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)

groupbyjob

# plot
ggplot2::ggplot(groupbyjob, aes(x = Employment_Classification, y = freq)) +
  geom_col() 

````


## Household members
What is the household members distribution?

```{r frequency}

groupbyhmem <- socialdemo %>%
  dplyr::group_by(Household_members) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)

groupbyhmem

# plot
ggplot2::ggplot(groupbyhmem, aes(x = Household_members, y = freq)) +
  geom_col() 

````


## Income Earners
What is the income earners distribution?

```{r frequency}

groupbyinc <- socialdemo %>%
  dplyr::group_by(Income_earners) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)

groupbyinc

# plot
ggplot2::ggplot(groupbyinc, aes(x = Income_earners, y = freq)) +
  geom_col() 


````

## Fortnight Income
What is the Fortnight distribution?

```{r frequency}

groupbyfort <- socialdemo %>%
  dplyr::group_by(Fortnight_income) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)

groupbyfort

# plot
ggplot2::ggplot(groupbyfort, aes(x = Fortnight_income, y = freq)) +
  geom_col() 


````

## Village 
What is the village distribution?

```{r frequency}

groupbyvil <- socialdemo %>%
  dplyr::group_by(Village) %>%
  dplyr::summarize(n = n()) %>%
  dplyr::mutate(freq = n / sum(n)*100)

groupbyvil

# plot
ggplot2::ggplot(groupbyvil, aes(x = Village, y = freq)) +
  geom_col() 
````

